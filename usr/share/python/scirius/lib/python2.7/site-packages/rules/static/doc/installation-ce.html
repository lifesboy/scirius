
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Installation and setup &#8212; Scirius 3.4.0 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: ''
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Manage Accounts" href="local-user-management.html" />
    <link rel="prev" title="Introduction" href="intro-ce.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="local-user-management.html" title="Manage Accounts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro-ce.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Scirius 3.4.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="installation-and-setup">
<h1>Installation and setup<a class="headerlink" href="#installation-and-setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installing-scirius-ce">
<h2>Installing Scirius CE<a class="headerlink" href="#installing-scirius-ce" title="Permalink to this headline">¶</a></h2>
<p>Scirius CE is an application written in <a class="reference external" href="https://www.djangoproject.com/">Django</a>. It requires
at least Django 1.11 and has not yet support for Django 2.0.</p>
<p>Scirius CE also uses <a class="reference external" href="https://webpack.js.org/">webpack</a> to build CSS and JS bundles.</p>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<p>The easy way to install the dependencies is to use <a class="reference external" href="https://pypi.python.org/pypi/pip">pip</a>:</p>
<p>On Debian, you can run</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aptitude</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>You can then install django and the dependencies</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>To use the suri_reloader script which is handling suricata restart, you will also need
pyinotify</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyinotify</span>
</pre></div>
</div>
<p>It has been reported that on some Debian system forcing a recent GitPython is required</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">gitpython</span><span class="o">==</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">beta2</span>
</pre></div>
</div>
<p>You will also potentially needs the gitdb module</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">gitdb</span>
</pre></div>
</div>
<p>For npm and webpack, you need a stable version of npm and webpack version 3.11. On Debian
you can do</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">npm</span>
<span class="n">sudo</span> <span class="n">npm</span> <span class="n">install</span> <span class="o">-</span><span class="n">g</span> <span class="n">npm</span><span class="nd">@latest</span> <span class="n">webpack</span><span class="nd">@3</span><span class="o">.</span><span class="mi">11</span>
<span class="n">npm</span> <span class="n">install</span>
<span class="n">cd</span> <span class="n">hunt</span>
<span class="n">npm</span> <span class="n">install</span>
<span class="n">npm</span> <span class="n">run</span> <span class="n">build</span>
</pre></div>
</div>
</div>
<div class="section" id="running-scirius-ce">
<h3>Running Scirius CE<a class="headerlink" href="#running-scirius-ce" title="Permalink to this headline">¶</a></h3>
<p>From inside the source directory, you can initiate Django database</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span>
</pre></div>
</div>
<p>Authentication is by default in scirius so you will need to create a superuser
account</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">createsuperuser</span>
</pre></div>
</div>
<p>Before starting the application you need to construct the bundles by running webpack and collect static files:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">webpack</span>
<span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">collectstatic</span>
</pre></div>
</div>
<p>This step as to be done after each code update.</p>
<p>One of the easiest way to try Scirius CE is to run the Django test server</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">runserver</span>
</pre></div>
</div>
<p>You can then connect to <code class="docutils literal"><span class="pre">localhost:8000</span></code>.</p>
<p>If you need the application to listen to a reachable address, you can run
something like</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">runserver</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span><span class="p">:</span><span class="mi">8000</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="suricata-setup">
<h2>Suricata setup<a class="headerlink" href="#suricata-setup" title="Permalink to this headline">¶</a></h2>
<p>Scirius CE is generating one single rules files with all activated rules. When editing
the Suricata object, you have to setup the directory where you want this file to be generated
and the associated files of the ruleset to be copied.</p>
<p>Scirius CE won&#8217;t touch your Suricata configuration file aka <code class="docutils literal"><span class="pre">suricata.yaml</span></code>. So you have
to update it to point to the directory where data are setup by Scirius CE. If you are
only using rules generated by Scirius CE, you should have something looking like in
your <code class="docutils literal"><span class="pre">suricata.yaml</span></code> file</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">default</span><span class="o">-</span><span class="n">rule</span><span class="o">-</span><span class="n">path</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">rules</span>
<span class="n">rule</span><span class="o">-</span><span class="n">files</span><span class="p">:</span>
 <span class="o">-</span> <span class="n">scirius</span><span class="o">.</span><span class="n">rules</span>
</pre></div>
</div>
<p>To use the <cite>Use IP reputation instead of group</cite> feature you also need to have</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">reputation</span><span class="o">-</span><span class="n">categories</span><span class="o">-</span><span class="n">file</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">rules</span><span class="o">/</span><span class="n">scirius</span><span class="o">-</span><span class="n">categories</span><span class="o">.</span><span class="n">txt</span>
<span class="n">default</span><span class="o">-</span><span class="n">reputation</span><span class="o">-</span><span class="n">path</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">rules</span>
<span class="n">reputation</span><span class="o">-</span><span class="n">files</span><span class="p">:</span>
 <span class="o">-</span> <span class="n">scirius</span><span class="o">-</span><span class="n">iprep</span><span class="o">.</span><span class="n">list</span>
</pre></div>
</div>
<p>To interact with Scirius CE, you need to detect when <code class="docutils literal"><span class="pre">/path/to/rules/scirius.reload</span></code> file
are created, initiate a reload or restart of Suricata when it is the case and delete the
reload file once this is done.</p>
<p>One possible way to do that is to use <code class="docutils literal"><span class="pre">suri_reloader</span></code> available in <code class="docutils literal"><span class="pre">suricata/scripts</span></code>
directory. The syntax of <code class="docutils literal"><span class="pre">suri_reloader</span></code> can be something similar to</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">suri_reloader</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">rules</span>  <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">suri</span><span class="o">-</span><span class="n">reload</span><span class="o">.</span><span class="n">log</span>  <span class="o">-</span><span class="n">D</span>
</pre></div>
</div>
<p>Use <code class="docutils literal"><span class="pre">-h</span></code> option to get the complete list of options. Please note that <code class="docutils literal"><span class="pre">suri_reloaded</span></code>
uses the <code class="docutils literal"><span class="pre">service</span></code> command to restart or reload Suricata. This means you need a init
script to get it working.</p>
</div>
<div class="section" id="link-with-elasticsearch">
<h2>Link with Elasticsearch<a class="headerlink" href="#link-with-elasticsearch" title="Permalink to this headline">¶</a></h2>
<p>If you are using Suricata with Eve logging and Elasticsearch, you can get information
about signatures displayed in the page showing information about Suricata:</p>
<img alt="elasticsearch info in scirius" class="align-center" src="_images/suricata-display.png" />
<p>You can also get graph and details about a specific rule:</p>
<img alt="rule info in scirius" class="align-center" src="_images/rule-detail.png" />
<p>To setup Elasticsearch connection, you can edit <code class="docutils literal"><span class="pre">settings.py</span></code> or create a
<code class="docutils literal"><span class="pre">local_settings.py</span></code> file under <code class="docutils literal"><span class="pre">scirius</span></code> directory to setup the feature.
Elasticsearch is activated if a variable names <code class="docutils literal"><span class="pre">USE_ELASTICSEARCH</span></code> is set
to True in <code class="docutils literal"><span class="pre">settings.py</span></code>. The address of the Elasticsearch is stored in the
<code class="docutils literal"><span class="pre">ELASTICSEARCH_ADDRESS</span></code> variable and uses the format <code class="docutils literal"><span class="pre">IP:port</span></code>.</p>
<p>For example, if your Elasticsearch is running locally, you can add
to <code class="docutils literal"><span class="pre">local_settings.py</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">USE_ELASTICSEARCH</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ELASTICSEARCH_ADDRESS</span> <span class="o">=</span> <span class="s2">&quot;127.0.0.1:9200&quot;</span>
</pre></div>
</div>
<p>Please note, that the name of the Suricata (set during edition of the object) must
be equal to the <code class="docutils literal"><span class="pre">host</span></code> key present in Elasticsearch events. It can also be edited here: scirius -&gt; suricata -&gt; edit.</p>
<p>On logstash side, the only necessary thing is to make sure that the &#64;timestamp is equal
to the timestamp value provided in Suricata events. To do so and if you Suricata events
are of type <cite>SELKS</cite> on can use</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">filter</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">[</span><span class="nb">type</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SELKS&quot;</span> <span class="p">{</span>
    <span class="n">date</span> <span class="p">{</span>
      <span class="n">match</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;ISO8601&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is necessary to avoid glitch in the graphics generated by Scirius CE.</p>
</div>
<div class="section" id="link-with-kibana">
<h2>Link with Kibana<a class="headerlink" href="#link-with-kibana" title="Permalink to this headline">¶</a></h2>
<p>If you are using Kibana, it is possible to get links to your dashboards by clicking the
top left icon:</p>
<img alt="kibana dropdown menu" class="align-center" src="_images/kibana-link.png" />
<p>To activate the feature, you need to edit your <cite>local_settings.py</cite> file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">KIBANA_URL</span> <span class="o">=</span> <span class="s2">&quot;http://localhost/&quot;</span>
<span class="n">USE_KIBANA</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installation and setup</a><ul>
<li><a class="reference internal" href="#installing-scirius-ce">Installing Scirius CE</a><ul>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#running-scirius-ce">Running Scirius CE</a></li>
</ul>
</li>
<li><a class="reference internal" href="#suricata-setup">Suricata setup</a></li>
<li><a class="reference internal" href="#link-with-elasticsearch">Link with Elasticsearch</a></li>
<li><a class="reference internal" href="#link-with-kibana">Link with Kibana</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro-ce.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="local-user-management.html"
                        title="next chapter">Manage Accounts</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2020, Stamus Networks.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.
    </div>
  </body>
</html>